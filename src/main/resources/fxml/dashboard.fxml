<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ChoiceBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.MenuButton?>
<?import javafx.scene.control.MenuItem?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.SeparatorMenuItem?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.ToggleButton?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>

<BorderPane fx:id="root" prefHeight="700" prefWidth="1200" styleClass="root" xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="br.com.creche.controller.DashboardController">

    <!-- Top App Bar -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="12" styleClass="app-bar">
            <children>
                <Label fx:id="telaAtual" styleClass="app-title" text="Dashboard" />
                <Region>
                    <HBox.hgrow>ALWAYS</HBox.hgrow>
                </Region>
                <TextField fx:id="txtBuscaGlobal" prefWidth="300" promptText="Buscar O.S., usuário..." />
                <MenuButton fx:id="mbUser" text="Admin">
                    <items>
                        <MenuItem onAction="#onPerfil" text="Perfil" />
                        <SeparatorMenuItem />
                        <MenuItem onAction="#onSair" text="Sair" />
                        <MenuItem onAction="#onSairESemLembrar" text="Sair e esquecer login" />
                    </items>
                </MenuButton>
            </children>
            <padding>
                <Insets bottom="8" left="16" right="16" top="8" />
            </padding>
        </HBox>
    </top>

    <!-- Side Menu -->
    <left>
        <VBox prefWidth="220" spacing="8" styleClass="side-menu">
            <children>
                <Label styleClass="side-title" text="Navegação" />
            <HBox alignment="CENTER_LEFT" prefHeight="50.0" prefWidth="106.0">
               <children>
                  <ImageView fitHeight="40.0" fitWidth="40.0" pickOnBounds="true" preserveRatio="true">
                     <image>
                        <Image url="@../images/home-local-alt%20(1).png" />
                     </image>
                  </ImageView>
                      <ToggleButton fx:id="tbDashboard" onAction="#goDashboard" prefHeight="25.0" prefWidth="45.0" selected="true" text="Início" />
               </children>
            </HBox>
                <ToggleButton fx:id="tbOS" onAction="#goOS" prefHeight="25.0" text="Ordens de Serviço" />
                <ToggleButton fx:id="tbUsuarios" onAction="#goUsuarios" prefHeight="25.0" text="Usuários" />
                <ToggleButton fx:id="tbRelatorios" onAction="#goRelatorios" prefHeight="25.0" text="Relatórios" />
                <ToggleButton fx:id="tbConfiguracoes" onAction="#goConfiguracoes" prefHeight="25.0" text="Configurações" />
                <Region>
                    <VBox.vgrow>ALWAYS</VBox.vgrow>
                </Region>
            <HBox prefHeight="100.0" prefWidth="200.0" />
            <HBox prefHeight="100.0" prefWidth="200.0" />
            <HBox prefHeight="100.0" prefWidth="200.0" />
                <Label styleClass="muted" text="v1.0.0" />
            </children>
            <padding>
                <Insets bottom="16" left="12" right="12" top="16" />
            </padding>
        </VBox>
    </left>

    <!-- Content -->
    <center>
        <ScrollPane fitToWidth="true">
            <content>
                <VBox spacing="16">
                    <padding>
                        <Insets bottom="16" left="16" right="16" top="16" />
                    </padding>
                    <children>

                        <!-- KPIs simples -->
                        <HBox spacing="16">
                            <children>
                                <VBox prefWidth="220" spacing="4" styleClass="card kpi-card">
                                    <children>
                                        <Label styleClass="kpi-title" text="Abertas" />
                                        <Label fx:id="lblKpiAbertas" styleClass="kpi-value" text="0" />
                                    </children>
                                    <padding>
                                        <Insets bottom="16" left="16" right="16" top="16" />
                                    </padding>
                                </VBox>
                                <VBox prefWidth="220" spacing="4" styleClass="card kpi-card">
                                    <children>
                                        <Label styleClass="kpi-title" text="Em Andamento" />
                                        <Label fx:id="lblKpiEmAndamento" styleClass="kpi-value" text="0" />
                                    </children>
                                    <padding>
                                        <Insets bottom="16" left="16" right="16" top="16" />
                                    </padding>
                                </VBox>
                                <VBox prefWidth="220" spacing="4" styleClass="card kpi-card">
                                    <children>
                                        <Label styleClass="kpi-title" text="Concluídas (mês)" />
                                        <Label fx:id="lblKpiConcluidas" styleClass="kpi-value" text="0" />
                                    </children>
                                    <padding>
                                        <Insets bottom="16" left="16" right="16" top="16" />
                                    </padding>
                                </VBox>
                                <VBox prefWidth="220" spacing="4" styleClass="card kpi-card">
                                    <children>
                                        <Label styleClass="kpi-title" text="Atrasadas" />
                                        <Label fx:id="lblKpiAtrasadas" styleClass="kpi-value" text="0" />
                                    </children>
                                    <padding>
                                        <Insets bottom="16" left="16" right="16" top="16" />
                                    </padding>
                                </VBox>
                            </children>
                        </HBox>

                        <!-- Tabela + Gráfico -->
                        <HBox spacing="16">
                            <children>
                                <VBox spacing="8" styleClass="card">
                                    <VBox.vgrow>ALWAYS</VBox.vgrow>
                                    <children>
                                        <HBox alignment="CENTER_LEFT" spacing="8">
                                            <children>
                                                <Label styleClass="section-title" text="O.S. Recentes" />
                                                <Region>
                                                    <HBox.hgrow>ALWAYS</HBox.hgrow>
                                                </Region>
                                                <ChoiceBox fx:id="cbFiltroStatus" />
                                                <Button fx:id="btnNovaOS" onAction="#onNovaOS" styleClass="primary" text="Nova O.S." />
                                                <Button fx:id="btnApagarOS" onAction="#onApagarOS" styleClass="danger" text="Apagar O.S." />
                                            </children>
                                        </HBox>
                                        <TableView fx:id="tvOSRecentes" prefHeight="360">
                                            <VBox.vgrow>ALWAYS</VBox.vgrow>
                                            <columns>
                                                <TableColumn fx:id="colNumero" prefWidth="120" text="Número" />
                                                <TableColumn fx:id="colTitulo" prefWidth="240" text="Título" />
                                                <TableColumn fx:id="colCategoria" prefWidth="140" text="Categoria" />
                                                <TableColumn fx:id="colPrioridade" prefWidth="110" text="Prioridade" />
                                                <TableColumn fx:id="colSolicitante" prefWidth="160" text="Solicitante" />
                                                <TableColumn fx:id="colResponsavel" prefWidth="160" text="Responsável" />
                                                <TableColumn fx:id="colStatus" prefWidth="120" text="Status" />
                                                <TableColumn fx:id="colPrazo" prefWidth="160" text="Prazo" />
                                            </columns>
                                        </TableView>
                                    </children>
                                    <padding>
                                        <Insets bottom="16" left="16" right="16" top="16" />
                                    </padding>
                                </VBox>

                                <VBox prefWidth="380" spacing="8" styleClass="card">
                                    <children>
                                        <Label styleClass="section-title" text="Por Status" />
                                        <PieChart fx:id="pcStatus" prefHeight="360" />
                                    </children>
                                    <padding>
                                        <Insets bottom="16" left="16" right="16" top="16" />
                                    </padding>
                                </VBox>
                            </children>
                        </HBox>

                    </children>
                </VBox>
            </content>
        </ScrollPane>
    </center>
</BorderPane>
